@model IEnumerable<LojaDeReparações.Models.Reparacao>

@{
    ViewBag.Title = "Reparações";
}

<h2>Lista de Reparações</h2>

<p>
    @if (User.IsInRole("Administrador") || User.IsInRole("Funcionário"))
    {
        @Html.ActionLink("Associar Reparação", "Create") <span>|</span>
        @Html.ActionLink("Lista de dispositivos em espera", "ListaDispositivosEmEspera"); <span>|</span>
        @Html.ActionLink("Lista de reparações em curso", "ListaDeReparacoesEmCurso");
}
</p>
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.dispositivo.Marca)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.dispositivo.Problema)
        </th>
        <th>
            Funcionário
        </th>
        <th>
            Cliente
        </th>
        <th>
            @Html.DisplayNameFor(model => model.data_inicio)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.data_fim)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Estado)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.preco)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.dispositivo.Marca)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.dispositivo.Problema)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.u.Nome)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.utilizador.Nome)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.data_inicio)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.data_fim)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Estado)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.preco)
        </td>
        <td>

            @Html.ActionLink("Detalhes", "Details", new { id = item.Id }) <span>|</span>
            @if (User.IsInRole("Cliente") && item.Estado == 2)
             {
                @Html.ActionLink("Pagar", "Pagar", new { id = item.Id}) <span>|</span>
             }
            @if (User.IsInRole("Administrador") || User.IsInRole("Funcionário"))
            {
                @Html.ActionLink("Editar", "Edit", new { id = item.Id }) <span>|</span>
      
                if (item.Estado == 0)
                {
                    @Html.ActionLink("Eliminar", "Delete", new { id = item.Id })
                }
            }
        </td>
    </tr>
}

</table>
